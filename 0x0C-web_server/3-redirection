#!/usr/bin/env bash
# Script to configure Nginx for redirection on a new Ubuntu machine

# URL to redirect to
link="https://github.com/lebogangolifant"

# Update package list and install Nginx
apt update
apt install -y nginx

# Allow Nginx through the firewall
ufw allow 'Nginx HTTP'

# Create the Hello World HTML page
echo "Hello World" > /var/www/html/index.html

# Update the default Nginx configuration with the 301 redirect
sed -i "/location \/ {/ a \\
    location /redirect_me/ {\\
        rewrite ^/redirect_me/\$ $link permanent;\\
    }" /etc/nginx/sites-available/default

# Restart Nginx to apply the configuration changes
service nginx restart
